pipeline {
    agent { label 'agent1' }

    stages {
        stage('Hello') {
            steps {
                echo 'Hello World'
            }
        }
        stage('Maven') {
            steps {
                sh 'mvn --version'
            }
        }
        stage('SonarQube Analysis') {
            steps {
                script {
                    def sonarUrl = params.SONAR_URL ?: 'http://172.29.86.231:9000/' 
                    withSonarQubeEnv('SonarQube Server', sonarUrl) {
                        sh "/opt/sonarqube/bin/sonar-scanner -Dsonar.login=sqp_a3af6a004eb18eaf862cf8b971c110d762731479"
                    }
                }
            }
        }
    }
}
